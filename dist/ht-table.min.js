/*!
 * angular-ht-ng-table
 * https://github.com/hightest/angular-ng-table
 * Version: 0.0.1 - 2015-03-01T13:40:20.296Z
 * License: 
 */
var app=angular.module("ht.table",["ui.bootstrap"]);app.directive("htTable",function(){return{templateUrl:"ht-table.html",scope:{htTable:"="},controller:["$scope","orderByFilter",function(e,t){var a=this,n=e.htTable,i=angular.isDefined(n.rowClick)?n.rowClick:function(){},l=angular.isDefined(n.expand)?n.expand:function(){},r=angular.isDefined(n.postSorting)?n.postSorting:function(){},o=angular.isDefined(n.checked)?n.checked:function(){};a.id=angular.isDefined(n.id)?n.id:"table",a.class=angular.isDefined(n.class)?n.class:[],a.selectMultiple=angular.isDefined(n.selectMultiple)?n.selectMultiple:!1;var s=angular.isDefined(n.active)?n.active:"",d=n.data,g=angular.isDefined(n.init)?n.init:function(){},c=null;a.fields=n.fields,a.pagination={total:0,current:1,itemsPerPage:10};var u=[];a.data=d,angular.forEach(a.fields,function(e){angular.isDefined(e.sort)&&u.push({field:e.value,sort:e.sort})}),e.$watch("htTable",function(e,t){e!=t&&(d=e.data,a.reloadTable())},!0),angular.forEach(a.fields,function(e){angular.isUndefined(e.visible)&&(e.visible=!0)}),a.reloadTable=function(){if(0!==d.length){var e=[];angular.forEach(u,function(t){var a="";a="asc"==t.sort?"+":"-",a+=t.field,e.push(a)});var n=u.length?t(d,e):d;angular.isFunction(g)&&(g(n,a.pagination),g=null),a.pagination.total=n.length,a.data=a.pagination.itemsPerPage?n.slice((a.pagination.current-1)*a.pagination.itemsPerPage,a.pagination.current*a.pagination.itemsPerPage):n}},a.reloadTable(),e.$watch(function(){return a.pagination.itemsPerPage},function(e,t){e!=t&&(a.pagination.current=1,a.reloadTable())}),a.expand=function(e){return c=e,i(e)},a.show=function(e){return l(e)},a.pageChanged=function(){this.reloadTable()},a.pages=function(){return parseInt(a.pagination.total/a.pagination.itemsPerPage)+1},a.rowStyle=function(e){return a.selectMultiple&&e.checked||e==c?s:""},a.getFieldClass=function(e){for(var t=0;t<u.length;t++)if(e.value==u[t].field)return"asc"==u[t].sort?"ht-table-icon-up":"ht-table-icon-down";return""};var f=function(e){for(var t=0;t<u.length;t++)if(u[t].field==e.value)return t;return null};a.changeSorting=function(e,t){var n=t.shiftKey,i=f(e),l={};if(l=null===i?{field:e.value,sort:"asc"}:u[i],null!==i){var o=l.sort;"asc"==o?(u[i].sort="desc",n||(u=[u[i]])):n?u.splice(i,1):u=[]}else n?u.push(l):u=[l];r(u,a.pagination),a.reloadTable()},a.countColumns=function(){var e=1;return angular.forEach(a.fields,function(t){t.visible&&e++}),a.selectMultiple&&e++,e},a.checkedChange=function(){var e=a.getCheckedElements();o(e)},a.hasSum=function(){for(var e=0;e<a.fields.length;e++)if(angular.isDefined(a.fields[e].type)&&"sum"==a.fields[e].type)return!0;return!1},a.getCheckedElements=function(){var e=[];return angular.forEach(a.data,function(e){angular.isDefined(e.checked)&&e.checked&&this.push(e)},e),e},a.sum=function(e){var t=0,n=a.getCheckedElements();return n.length||(n=d),angular.forEach(n,function(a){t+=a[e]}),t},a.getValue=function(e,t){var a=e.split("."),n=angular.copy(t);return a.forEach(function(e){n=n.hasOwnProperty(e)?n[e]:""}),n},a.isTemplate=function(e){return"template"==e.type}}],controllerAs:"table"}}),angular.module("ht.table").run(["$templateCache",function(e){e.put("ht-table.html",'<div class="table-responsive"><table class="table table-bordered" id="{{table.id}}" ng-class="table.class"><thead><tr><th><div dropdown="" class="btn-group"><button class="btn btn-default dropdown-toggle" type="button" dropdown-toggle=""><span class="glyphicon glyphicon-cog" aria-hidden="true"></span></button><ul class="dropdown-menu" role="menu" ng-click="$event.stopPropagation()"><li ng-repeat="field in table.fields" ng-if="!table.isTemplate(field)"><label><input type="checkbox" ng-model="field.visible">{{field.name}}</label></li></ul></div></th><th ng-if="table.selectMultiple"></th><th ng-repeat="field in table.fields" ng-if="field.visible" ng-click="table.changeSorting(field, $event)" ng-class="table.getFieldClass(field)" style="cursor:pointer">{{field.name}}</th></tr></thead><tbody><tr ng-repeat-start="row in table.data" ng-class="table.rowStyle(row)"><td>{{(table.pagination.current - 1) * table.pagination.itemsPerPage + $index + 1}}.</td><th scope="row" ng-if="table.selectMultiple"><input type="checkbox" ng-model="row.checked" ng-change="table.checkedChange()"></th><td ng-repeat="field in table.fields" ng-if="field.visible" ng-click="table.expand(row)"><div ng-if="!table.isTemplate(field)">{{table.getValue(field.value, row)}}</div><div ng-if="table.isTemplate(field)" ng-include="field.templateUrl"></div></td></tr><tr ng-repeat-end="" ng-if="table.show(row)"><td colspan="{{table.countColumns()}}"><div ui-view=""></div></td></tr></tbody><tfoot ng-if="table.hasSum()"><tr><td>&nbsp;</td><td ng-if="table.selectMultiple">&nbsp;</td><td ng-repeat="field in table.fields" ng-if="field.visible"><span ng-if="field.type == \'sum\'">Suma: {{table.sum(field.value) | number:2}}</span></td></tr></tfoot></table></div><div class="row"><div class="col-xs-6" ng-if="table.pages() > 1"><pagination total-items="table.pagination.total" ng-model="table.pagination.current" ng-change="table.pageChanged()" max-size="5" items-per-page="table.pagination.itemsPerPage" previous-text="&laquo;" next-text="&raquo;"></pagination></div><div class="btn-group col-xs-6" ng-if="table.pagination.total > 10"><label class="btn btn-primary" ng-model="table.pagination.itemsPerPage" btn-radio="10">10</label> <label class="btn btn-primary" ng-model="table.pagination.itemsPerPage" btn-radio="25">25</label> <label class="btn btn-primary" ng-if="table.pagination.total > 25" ng-model="table.pagination.itemsPerPage" btn-radio="50">50</label> <label class="btn btn-primary" ng-if="table.pagination.total > 50" ng-model="table.pagination.itemsPerPage" btn-radio="100">100</label> <label class="btn btn-primary" ng-model="table.pagination.itemsPerPage" btn-radio="0">Wszystkie</label></div></div>')}]);